#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon May 18 11:29:26 2020

@author: yash
"""

import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.multiclass import OneVsRestClassifier
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
dataset = pd.read_csv('labelledW2Vec.csv')
X = dataset.iloc[:,:-2].values
y = dataset.iloc[:,512].values

X_train = X[0:5600]
X_test = X[5600:6301]
y_train = y[0:5600]
y_test = y[5600:6301]



model = LogisticRegression(solver = 'newton-cg', C = 0.5 , random_state = None, max_iter = 500)

ovr = OneVsRestClassifier(model)

ovr.fit(X_train, y_train)


y_pred = ovr.predict(X_test)

print("Accuracy of the model is:")
acc = accuracy_score(y_test, y_pred)
print(acc)
print(confusion_matrix(y_test, y_pred))
print(classification_report(y_test, y_pred, target_names=['BHO', 'CeeInject','FakeRean', 'OnLineGames','Renos', 'Vobfus','Winwebsec']))
